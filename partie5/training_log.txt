[I 2025-11-17 16:20:38,214] A new study created in memory with name: asr_hyperparameter_tuning
Using device: cuda

Loading LibriSpeech from ../LibriSpeech/dev-clean...
Loaded 300 samples

Starting hyperparameter optimization with Optuna...
  0%|          | 0/10 [00:00<?, ?it/s]/home/leo/Bureau/Speech_to_text_project/partie5/part5_hyperparameter_tuning.py:282: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  learning_rate = trial.suggest_loguniform('learning_rate', 1e-4, 1e-2)
                                        0%|          | 0/10 [00:00<?, ?it/s]                                        0%|          | 0/10 [00:00<?, ?it/s]  0%|          | 0/10 [00:00<?, ?it/s]
[W 2025-11-17 16:20:38,224] Trial 0 failed with parameters: {'feature_type': 'mfcc', 'n_features': 47, 'architecture': 'gru', 'hidden_size': 256, 'num_layers': 4, 'dropout': 0.2944471323961333, 'learning_rate': 0.007224490165536689, 'batch_size': 8, 'bidirectional': False, 'noise_level': 0.09507813444176441} because of the following error: ValueError('Cannot select more MFCC coefficients than # mel bins').
Traceback (most recent call last):
  File "/home/leo/Bureau/Speech_to_text_project/venv/lib/python3.12/site-packages/optuna/study/_optimize.py", line 205, in _run_trial
    value_or_values = func(trial)
                      ^^^^^^^^^^^
  File "/home/leo/Bureau/Speech_to_text_project/partie5/part5_hyperparameter_tuning.py", line 358, in <lambda>
    lambda trial: objective(trial, audio_paths, transcripts, device),
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/leo/Bureau/Speech_to_text_project/partie5/part5_hyperparameter_tuning.py", line 293, in objective
    feature_extractor = AudioFeatureExtractor(feature_type=feature_type, n_features=n_features)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/leo/Bureau/Speech_to_text_project/partie5/part5_hyperparameter_tuning.py", line 31, in __init__
    self.transform = torchaudio.transforms.MFCC(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/leo/Bureau/Speech_to_text_project/venv/lib/python3.12/site-packages/torchaudio/transforms/_transforms.py", line 687, in __init__
    raise ValueError("Cannot select more MFCC coefficients than # mel bins")
ValueError: Cannot select more MFCC coefficients than # mel bins
[W 2025-11-17 16:20:38,224] Trial 0 failed with value None.
Traceback (most recent call last):
  File "/home/leo/Bureau/Speech_to_text_project/partie5/part5_hyperparameter_tuning.py", line 535, in <module>
    main()
  File "/home/leo/Bureau/Speech_to_text_project/partie5/part5_hyperparameter_tuning.py", line 357, in main
    study.optimize(
  File "/home/leo/Bureau/Speech_to_text_project/venv/lib/python3.12/site-packages/optuna/study/study.py", line 490, in optimize
    _optimize(
  File "/home/leo/Bureau/Speech_to_text_project/venv/lib/python3.12/site-packages/optuna/study/_optimize.py", line 67, in _optimize
    _optimize_sequential(
  File "/home/leo/Bureau/Speech_to_text_project/venv/lib/python3.12/site-packages/optuna/study/_optimize.py", line 164, in _optimize_sequential
    frozen_trial_id = _run_trial(study, func, catch)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/leo/Bureau/Speech_to_text_project/venv/lib/python3.12/site-packages/optuna/study/_optimize.py", line 262, in _run_trial
    raise func_err
  File "/home/leo/Bureau/Speech_to_text_project/venv/lib/python3.12/site-packages/optuna/study/_optimize.py", line 205, in _run_trial
    value_or_values = func(trial)
                      ^^^^^^^^^^^
  File "/home/leo/Bureau/Speech_to_text_project/partie5/part5_hyperparameter_tuning.py", line 358, in <lambda>
    lambda trial: objective(trial, audio_paths, transcripts, device),
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/leo/Bureau/Speech_to_text_project/partie5/part5_hyperparameter_tuning.py", line 293, in objective
    feature_extractor = AudioFeatureExtractor(feature_type=feature_type, n_features=n_features)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/leo/Bureau/Speech_to_text_project/partie5/part5_hyperparameter_tuning.py", line 31, in __init__
    self.transform = torchaudio.transforms.MFCC(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/leo/Bureau/Speech_to_text_project/venv/lib/python3.12/site-packages/torchaudio/transforms/_transforms.py", line 687, in __init__
    raise ValueError("Cannot select more MFCC coefficients than # mel bins")
ValueError: Cannot select more MFCC coefficients than # mel bins
